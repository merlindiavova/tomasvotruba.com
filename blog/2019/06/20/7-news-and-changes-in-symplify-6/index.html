<!DOCTYPE html>
<html lang="en">
    <head>
        <title>7 News and Changes in Symplify 6 | Tomas Votruba</title>
<meta charset="utf-8">
<meta name="robots" content="index, follow">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@votrubaT"/>

<meta property="og:image" content="/assets/images/tomas_votruba.jpg"/>

<link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">


<link rel="stylesheet" rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:700&amp;display=swap" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" media="print" onload="this.media='all'">

<link href="/assets/css/style.css?341682161" rel="stylesheet" type="text/css" />

                <meta property="og:title" content="7 News and Changes in Symplify 6" />
        <meta property="og:url" content="https://tomasvotruba.com/blog/2019/06/20/7-news-and-changes-in-symplify-6" />
        <meta name="description" property="og:description" content="Do you use Easy Coding Standard, Package Builder or Statie? Do you need to upgrade safely? **Do you want to benefit from new features?**


This post shows 7 news and changes, that might affect you (in a good way).
" />

            </head>

    <body>
        <!-- post_id: 214 -->
        <div id="menu">
    <div class="container-fluid">
        <a href="/">Home</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/blog">Blog</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/book/the-power-of-automated-refactoring">Book</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/trainings">Trainings</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/contact">Contact</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/about-me">About Me</a>
        <span class="pl-2 pr-2">•</span>

        <a href="https://twitter.com/votrubaT" target="blank">Twitter</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/rss.xml" target="blank">RSS</a>
    </div>
</div>

        <div class="container-fluid post" id="content">
            <div class="text-center book-banner">
                <a href="https://leanpub.com/rector-the-power-of-automated-refactoring" target="blank" class="text-center">
                    <img src="/assets/images/banner-rector-book.png" class="mb-2 ml-auto mr-auto rounded " style="max-height: 5em" alt="">
                </a>
            </div>

            <h1>7 News and Changes in Symplify 6</h1>

            <div class="pull-right">
                <a href="https://github.com/tomasvotruba/tomasvotruba.com/edit/main/packages/blog/data/2019/2019-06-20-7-news-and-changes-in-symplify-6.md">Found a typo? Edit me</a>
            </div>

            <time datetime="2019-06-Thu" class="text-muted">
                2019-06-20
            </time>

            
                            <div class="card border-success mt-4">
                    <div class="card-header text-white bg-success">
                        This post was updated at November 2020 with fresh know-how.
                        <br>
                        <strong>What is new?</strong>
                    </div>
                                            <div class="card-body pb-2">
                            <p>Switch from deprecated <code>--set</code> option to <code>rector.php</code> config.
Updated ECS YAML to PHP configuration since <strong>ECS 8</strong>.</p>
                        </div>
                                    </div>

                <br>
            
            <div class="card card-bigger mb-5">
                <div class="card-body pb-2">
                    <p>Do you use Easy Coding Standard, Package Builder or Statie? Do you need to upgrade safely? <strong>Do you want to benefit from new features?</strong>
<br>
<br>
This post shows 7 news and changes, that might affect you (in a good way).</p>
                </div>
            </div>

            <p>What is <strong>new</strong>?</p>
<h2 id="EasyCodingStandard">EasyCodingStandard</h2>
<h3 id="1-Run-Checker-only-on-Specific-Path">1. Run Checker only on Specific Path</h3>
<p><a href="https://github.com/symplify/symplify/pull/1537" class="btn btn-dark btn-sm pull-right mt-2 mb-2">
&nbsp;
See PR #1357
</a></p>
<p><strong>I really love this feature, because it makes a lot of custom boiler code go away.</strong></p>
<p>In old <em>Symplify 5</em>, when you needed to run sniff only on <code>/tests</code>, you had to create own config, e.g. <code>ecs-only-for-tests.php</code> and run it separately.</p>
<pre><code class="language-bash">vendor/bin/ecs check src --config ecs.php
vendor/bin/ecs check tests --config tests-only-ecs.php</code></pre>
<p>That was way too complicated, right?</p>
<p><br></p>
<p>In new <em>Symplify 8</em>, you can use just one config with <code>only</code> option instead:</p>
<pre><code class="language-php">// ecs.php

use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
use Symplify\EasyCodingStandard\ValueObject\Option;

return function (ContainerConfigurator $containerConfigurator): void {
    $services = $containerConfigurator-&gt;services();

    // all rules must be registered
    $services-&gt;set(BasicSniff::class);
    $services-&gt;set(AnotherSniff::class);

    $parameters = $containerConfigurator-&gt;parameters();
    // here you can configure, what rules should only check particular paths
    $parameters-&gt;set(Option::ONLY, [
        AnotherSniff::class =&gt; [
            __DIR__ . '/tests/'
        ]
    ]);
};</code></pre>
<pre><code class="language-yaml">vendor/bin/ecs check src tests</code></pre>
<p>It's basically an inversion of <code>skip</code> parameter.</p>
<p><br>
<br>
<br></p>
<p>What has <strong>changed</strong>?</p>
<h3 id="2-yaml-php">2. <code>*.yaml</code> → <code>*.php</code></h3>
<p>As Symfony is <a href="https://github.com/symfony/symfony/issues/37186">moving to *.php</a> configuration, Symplify does too.</p>
<h2 id="EasyCodingStandard">EasyCodingStandard</h2>
<h3 id="3-Sets-are-Now-In-defined-in-SetList-Constants">3. Sets are Now In defined in <code>SetList</code> Constants</h3>
<p>Why? The sets are only string references, so its useless for human to remember them. Why not let IDE help us?</p>
<pre><code class="language-diff"> &lt;?php

 // ecs.php

 declare(strict_types=1);

 use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
+use Symplify\EasyCodingStandard\ValueObject\Option;
+use Symplify\EasyCodingStandard\ValueObject\Set\SetList;

 return function (ContainerConfigurator $containerConfigurator): void {
-    $containerConfigurator-&gt;import(__DIR__ . '/vendor/symplify/easy-coding-standard/config/php71.php');
+    $containerConfigurator-&gt;import(SetList::PHP_71);
 };</code></pre>
<h3 id="4-exclude-checkers-skip">4. <del>exclude_checkers</del> → <code>skip</code></h3>
<p>People confused this options and created <em>WTF</em> issues. That's why the <code>exclude_checkers</code> is now merged in <code>skip</code>, so you have less option names to remember:</p>
<pre><code class="language-diff"> // ecs.php
 use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
+use Symplify\EasyCodingStandard\ValueObject\Option;

 return function (ContainerConfigurator $containerConfigurator): void {
     $parameters = $containerConfigurator-&gt;parameters();
-    $parameters-&gt;set('exclude_checkers', [
+    $parameters-&gt;set(Option::SKIP, [
-        SomeFixer::class
+        SomeFixer::class =&gt; null,
     ]);
 };</code></pre>
<h2 id="PackageBuilder">PackageBuilder</h2>
<h3 id="5-Introducing-FinderSanitizer">5. Introducing <code>FinderSanitizer</code></h3>
<p>Do you like <code>SplFileInfo</code> that is 100 % sure the file exists? In that case, you use <code>Symplify\PackageBuilder\FileSystem\SmartFileInfo</code> instead of <code>SplFileInfo</code>. The easiest way to use it is via <code>FinderSanitizer</code> that is now available via <code>symplify/package-builder</code> package:</p>
<pre><code class="language-diff"> &lt;?php

 // ecs.php

 declare(strict_types=1);

 use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
+use Symplify\EasyCodingStandard\ValueObject\Option;

 return function (ContainerConfigurator $containerConfigurator): void {
     $services = $containerConfigurator-&gt;services();
-    $services-&gt;set(Symplify\EasyCodingStandard\Finder\FinderSanitizer);
+    $services-&gt;set(Symplify\PackageBuilder\FileSystem\FinderSanitizer);
 };</code></pre>
<h3 id="6-ConfigurableCollectorCompilerPass-AutowireArrayParameterCompilerPass">6. <del>ConfigurableCollectorCompilerPass</del> → <code>AutowireArrayParameterCompilerPass</code></h3>
<p>If you know collectors, you're using <code>ConfigurableCollectorCompilerPass</code>. It saves you so much time with configuration. The problem with that compiler pass, you still had to go to config to set it up, for no real advantage. And extra work for <a href="/blog/2019/02/14/why-config-coding-sucks/">no benefit sucks</a>. Also, there is big change someone will <a href="/blog/2018/08/27/why-and-how-to-avoid-the-memory-lock/">forget it</a> and create a bug.</p>
<p>So instead, <em>Symplify 6</em> adds better system to pass collected services of certain type to single service - <strong><a href="/blog/2018/11/12/will-autowired-arrays-finally-deprecate-tags-in-symfony-and-nette/">autowired arrays</a></strong>:</p>
<pre><code class="language-diff">&lt;?php declare(strict_types=1);

 use Symfony\Component\DependencyInjection\ContainerInterface;
-use Symplify\PackageBuilder\DependencyInjection\CompilerPass\ConfigurableCollectorCompilerPass;
+use Symplify\PackageBuilder\DependencyInjection\CompilerPass\AutowireArrayParameterCompilerPass;

 final class AppKernel extends Kernel
 {
     protected function build(ContainerBuilder $containerBuilder): void
     {
-        $containerBuilder-&gt;addCompilerPass(new ConfigurableCollectorCompilerPass());
+        $containerBuilder-&gt;addCompilerPass(new AutowireArrayParameterCompilerPass());
    }
}</code></pre>
<p><a href="/blog/2018/11/12/will-autowired-arrays-finally-deprecate-tags-in-symfony-and-nette/">This post</a> explains how to use it without ever touching config again.</p>
<h2 id="CodingStandard">CodingStandard</h2>
<h3 id="7-RemoveUselessDocBlockFixer-NoSuperfluousPhpdocTagsFixer">7. <del>RemoveUselessDocBlockFixer</del> → <code>NoSuperfluousPhpdocTagsFixer</code></h3>
<p><code>RemoveUselessDocBlockFixer</code> was removed, since <a href="https://github.com/FriendsOfPHP/PHP-CS-Fixer">PHP CS Fixer</a> now provides <code>NoSuperfluousPhpdocTagsFixer</code> with similar features:</p>
<pre><code class="language-diff"> // ecs.php
 use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;

 return function (ContainerConfigurator $containerConfigurator): void {
     $services = $containerConfigurator-&gt;services();

-    $services-&gt;set(Symplify\CodingStandard\Fixer\Commenting\RemoveUselessDocBlockFixer::class);
+    $services-&gt;set(PhpCsFixer\Fixer\Phpdoc\NoSuperfluousPhpdocTagsFixer::class);
 };</code></pre>
<p>That's all. It was easy, right?</p>
<p><br></p>
<p>Happy coding!</p>

            <br>


            <div class="card mt-5 border-warning">
                <div class="card-body text-center mt-2">
                    <p>
                        Have you find this post useful? <strong>Do you want more?</strong>
                    </p>
                    <p>
                        Follow me on <a href="https://twitter.com/votrubaT">Twitter</a>, <a href="/rss.xml">RSS</a> or support me on <a href="https://github.com/sponsors/TomasVotruba">GitHub Sponsors</a>.
                    </p>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-body text-white bg-success text-center">
                                            <a href="/blog/2019/06/17/how-to-upgrade-meetup-com-api-to-oauth2-with-guzzle" class="d-block">
                            <div>
                                Read next → <strong>How to upgrade Meetup.com API to OAuth2 with Guzzle</strong>
                            </div>
                        </a>
                                    </div>
            </div>

            <br>
            <br>

            <a name="comments"></a>
            <div id="disqus_thread"></div>

<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://itsworthsharing.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
        </div>

        <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>

        <link href="/assets/prism/prism.css" rel="stylesheet" type="text/css" />
        <script src="/assets/prism/prism.js"></script>

        <script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

        <script type="text/javascript">
            // @see https://stackoverflow.com/a/30776817/1348344
            var date = new Date();
            // display every 2nd hour, not to spam users
            if (date.getHours() % 2 === 1) {
                document.querySelector('.book-banner').style.display = 'visible';
            } else {
                document.querySelector('.book-banner').style.display = 'none';
            }
        </script>
    </body>
</html>
