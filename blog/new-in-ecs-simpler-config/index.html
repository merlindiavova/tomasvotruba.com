<!DOCTYPE html>
<html lang="en">
    <head>
        <title>New in ECS: Simpler Config | Tomas Votruba</title>
<meta charset="utf-8">
<meta name="robots" content="index, follow">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@votrubaT"/>

    <meta property="og:title" content="New in ECS: Simpler Config" />
    <meta property="og:url" content="https://tomasvotruba.com/blog/new-in-ecs-simpler-config" />

            <meta property="og:image" content="https://tomasvotruba.com/assets/images/posts/2022/ecs_warning.png" />
        <meta name="twitter:image" content="https://tomasvotruba.com/assets/images/posts/2022/ecs_warning.png"/>
    
<link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">


<link rel="stylesheet" rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:700&amp;display=swap" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" media="print" onload="this.media='all'">

<link href="/assets/css/style.css?302882399" rel="stylesheet" type="text/css" />

                <meta name="description" property="og:description" content="ECS runs on Symfony container configuration to build the service model. While it brings automated autowiring, array autowiring, and native container features, the downside is that ECS configuration syntax is complex and talkative.

We decided to simplify it so ECS is truly easy to use.
" />
    </head>

    <body>
        <!-- post_id: 352 -->
        <div id="menu">
    <div class="container-fluid">
        <a href="/">Home</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/blog">Blog</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/book/the-power-of-automated-refactoring">Book</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/trainings">Trainings</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/contact">Contact</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/about-me">About Me</a>
        <span class="pl-2 pr-2">•</span>

        <a href="https://twitter.com/votrubaT" target="blank">Twitter</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/rss.xml" target="blank">RSS</a>
    </div>
</div>

        <div class="container-fluid post" id="content">
            <div class="text-center book-banner">
                <a href="https://leanpub.com/rector-the-power-of-automated-refactoring" target="blank" class="text-center">
                    <img src="/assets/images/banner-rector-book.png" class="mb-2 ml-auto mr-auto rounded " style="max-height: 5em" alt="">
                </a>
            </div>

            <h1>New in ECS: Simpler Config</h1>

            <div class="pull-right">
                <a href="https://github.com/tomasvotruba/tomasvotruba.com/edit/main/packages/blog/data/2022/2022-05-09-new-in-ecs-simpler-config.md">Found a typo? Edit me</a>
            </div>

            <time datetime="2022-05-Mon" class="text-muted">
                2022-05-09
            </time>

            
            
            <div class="card card-bigger mb-5">
                <div class="card-body pb-2">
                    <p>ECS runs on Symfony container configuration to build the service model. While it brings automated autowiring, array autowiring, and native container features, the downside is that ECS configuration syntax is complex and talkative.
<br><br>
We decided to simplify it so ECS is truly easy to use.</p>
                </div>
            </div>

            <p>How do we configure ECS now?</p>
<pre><code class="language-php">use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
use Symplify\EasyCodingStandard\ValueObject\Option;

// ups, possible conflict with ContainerConfigurator
return static function (ContainerConfigurator $containerConfigurator): void {
    $parameters = $containerConfigurator-&gt;parameters();

    // too verbose params, constants and possible typo in param value
    $parameters-&gt;set(Option::PATHS, [[ // ups, "[[" typo
        __DIR__ . '/src/',
    ]]);

    $services = $containerConfigurator-&gt;services();
    $services-&gt;set(ArraySyntaxFixer::class);
};</code></pre>
<p><br></p>
<p>Phew! Such complexity is confusing just to read and easy to make an error in.</p>
<h2 id="The-new-Way-to-Configure-ECS">The new Way to Configure ECS</h2>
<p>The new ECS version introduces its own <code>ECSConfig</code>object that wraps around Symfony configuration and makes setup even more straightforward.</p>
<p><br></p>
<p>It brings:</p>
<ul>
<li>full IDE autocomplete,</li>
<li>isolation from Symfony - useful for Symfony projects</li>
<li>validation of configuration on entry</li>
<li>makes sure there are no duplicated rules in a single config that might lead to unexpected behavior</li>
</ul>
<p><br></p>
<p>How does it look?</p>
<pre><code class="language-php">use Symplify\EasyCodingStandard\Config\ECSConfig;
use Symplify\EasyCodingStandard\ValueObject\Set\SetList;

return static function (ECSConfig $ecsConfig): void {
    $ecsConfig-&gt;paths([
        __DIR__ . '/src',
    ]);

    $ecsConfig-&gt;rule(ArraySyntaxFixer::class);

    $ecsConfig-&gt;sets([SetList::PSR_12]);
};</code></pre>
<h2 id="How-to-upgrade-to-ECSConfig">How to upgrade to <code>ECSConfig</code>?</h2>
<p>First, upgrade your ECS to 10.2 to enjoy this feature. Then, replace <code>ContainerConfigurator</code> in your <code>ecs.php</code> with <code>ECSConfig</code>. And then? Use your IDE - <strong>autocomplete methods</strong> will lead you:</p>
<img src="/assets/images/posts/2022/ecs_config.gif" class="img-thumbnail mb-2" style="max-width: 45em">
<p><br></p>
<p>Do you configure your rules? Use <code>ruleWithConfiguration()</code> method:</p>
<pre><code class="language-php">    $ecsConfig-&gt;ruleWithConfiguration(ArraySyntaxFixer::class, [
        'syntax' =&gt; 'short',
    ]);</code></pre>
<p><br></p>
<p>What if you miss upgrading an imported config? Don't worry. We've added a <strong>safe checker</strong> that goes through provided configs and warns you about an old configuration.</p>
<img src="/assets/images/posts/2022/ecs_warning.png" class="img-thumbnail mb-2" style="max-width: 45em">
<p>So you won't miss any of your configs to upgrade.</p>
<p><br></p>
<p>Happy coding!</p>

            <br>


            <div class="card mt-5 border-warning">
                <div class="card-body text-center mt-2">
                    <p>
                        Have you find this post useful? <strong>Do you want more?</strong>
                    </p>
                    <p>
                        Follow me on <a href="https://twitter.com/votrubaT">Twitter</a>, <a href="/rss.xml">RSS</a> or support me on <a href="https://github.com/sponsors/TomasVotruba">GitHub Sponsors</a>.
                    </p>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-body text-white bg-success text-center">
                                            <a href="/blog/5-constant-lists-that-give-context-to-your-integers-and-strings" class="d-block">
                            <div>
                                Read next → <strong>5 Constant Lists That Give Context to your Integers and Strings</strong>
                            </div>
                        </a>
                                    </div>
            </div>

            <br>
            <br>

            <a name="comments"></a>
            <div id="disqus_thread"></div>

<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://itsworthsharing.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
        </div>

        <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>

        <link href="/assets/prism/prism.css" rel="stylesheet" type="text/css" />
        <script src="/assets/prism/prism.js"></script>

        <script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

        <script type="text/javascript">
            // @see https://stackoverflow.com/a/30776817/1348344
            var date = new Date();
            // display every 2nd hour, not to spam users
            if (date.getHours() % 2 === 1) {
                document.querySelector('.book-banner').style.display = 'visible';
            } else {
                document.querySelector('.book-banner').style.display = 'none';
            }
        </script>
    </body>
</html>
