<!DOCTYPE html>
<html lang="en">
    <head>
        <title>New in Coding Standard 4: Long Line Breaks Automated and 3 Legacy Prevention Fixers | Tomas Votruba</title>
<meta charset="utf-8">
<meta name="robots" content="index, follow">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@votrubaT"/>

<meta property="og:image" content="/assets/images/tomas_votruba.jpg"/>

<link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">


<link rel="stylesheet" rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:700&amp;display=swap" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" media="print" onload="this.media='all'">

<link href="/assets/css/style.css?1890014467" rel="stylesheet" type="text/css" />

                <meta property="og:title" content="New in Coding Standard 4: Long Line Breaks Automated and 3 Legacy Prevention Fixers" />
        <meta property="og:url" content="https://tomasvotruba.com/blog/2018/03/29/new-in-coding-standard-4-long-line-breaks-automated-and-3-legacy-prevention-fixers" />
        <meta name="description" property="og:description" content="Legacy code prevention, lines automated and clear naming of classes in huge projects.
That all is coming to Coding Standard 4 (still in alpha).

Are you curious what work will now these 4 news fixers handle for you? Look inside.
" />

                    <meta property="og:image" content="https://tomasvotruba.com/assets/images/posts/2018/symplify-4-cs/tweet.png" />
            <meta name="twitter:card" content="summary_large_image"/>
            </head>

    <body>
        <!-- post_id: 87 -->
        <div id="menu">
    <div class="container-fluid">
        <a href="/">Home</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/blog">Blog</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/book/the-power-of-automated-refactoring">Book</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/trainings">Trainings</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/contact">Contact</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/about-me">About Me</a>
        <span class="pl-2 pr-2">•</span>

        <a href="https://twitter.com/votrubaT" target="blank">Twitter</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/rss.xml" target="blank">RSS</a>
    </div>
</div>

        <div class="container-fluid post" id="content">
            <div class="text-center book-banner">
                <a href="https://leanpub.com/rector-the-power-of-automated-refactoring" target="blank" class="text-center">
                    <img src="/assets/images/banner-rector-book.png" class="mb-2 ml-auto mr-auto rounded " style="max-height: 5em" alt="">
                </a>
            </div>

            <h1>New in Coding Standard 4: Long Line Breaks Automated and 3 Legacy Prevention Fixers</h1>

            <div class="pull-right">
                <a href="https://github.com/tomasvotruba/tomasvotruba.com/edit/main/packages/blog/data/2018/2018-03-29-new-in-coding-standard-4-long-line-breaks-automated-and-3-legacy-prevention-fixers.md">Found a typo? Edit me</a>
            </div>

            <time datetime="2018-03-Thu" class="text-muted">
                2018-03-29
            </time>

            
                            <div class="card border-success mt-4">
                    <div class="card-header text-white bg-success">
                        This post was updated at August 2020 with fresh know-how.
                        <br>
                        <strong>What is new?</strong>
                    </div>
                                            <div class="card-body pb-2">
                            <p>Updated ECS YAML to PHP configuration since <strong>ECS 8</strong>.</p>
                        </div>
                                    </div>

                <br>
            
            <div class="card card-bigger mb-5">
                <div class="card-body pb-2">
                    <p>Legacy code prevention, lines automated and clear naming of classes in huge projects.
That all is coming to Coding Standard 4 (still in alpha).
<br><br>
Are you curious what work will now these 4 news fixers handle for you? Look inside.</p>
                </div>
            </div>

            <h2 id="1-Let-Coding-Standard-handle-Line-Length-for-You">1. Let Coding Standard handle Line Length for You</h2>
<p><a href="https://github.com/symplify/symplify/pull/749" class="btn btn-dark btn-sm mt-2 mb-3">
Check the PR #749
</a></p>
<p><em>I'm so happy to announce this fixer, because it saved my so many times and also motivates me to use decoupling to smaller, SRP classes.</em></p>
<p>If you use <code>LineLengthSniff</code>, you know it's painful to fix every error report it makes.</p>
<pre><code class="language-php">use PHP_CodeSniffer\Standards\Generic\Sniffs\Files\LineLengthSniff;
use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;

return function (ContainerConfigurator $containerConfigurator): void {
    $services = $containerConfigurator-&gt;services();

    $services-&gt;set(LineLengthSniff::class)
        -&gt;property('absoluteLineLimit', 120);
};</code></pre>
<p>The most typical use case is constructor dependencies. You code start small:</p>
<pre><code class="language-php">public function __construct(OneLittleDependency $oneLittleDependency)
{
}</code></pre>
<p>Then it grows...</p>
<pre><code class="language-php">public function __construct(OneLittleDependency $oneLittleDependency, AnotherLittleDependency $anotherLittleDependency)
{
}</code></pre>
<p>...and grows...</p>
<pre><code class="language-php">public function __construct(OneLittleDependency $oneLittleDependency, AnotherLittleDependency $anotherLittleDependency, $someParameter)
{
}</code></pre>
<p>...sniff screams, so you inline it...</p>
<pre><code class="language-php">public function __construct(
    OneLittleDependency $oneLittleDependency,
    AnotherLittleDependency $anotherLittleDependency,
    $someParameter
) {
}</code></pre>
<p>...then you refactor and merge 2 services to 1...</p>
<pre><code class="language-php">public function __construct(
    OneLittleDependency $oneLittleDependency,
    $someParameter
) {
}</code></pre>
<p>...and that is inconsistent and has no reason to be inlined, so you inline it...</p>
<pre><code class="language-php">public function __construct(OneLittleDependency $oneLittleDependency, $someParameter) {
}</code></pre>
<p>...and that is one of many reasons people don't like to decouple classes and keep them small.</p>
<p><br></p>
<p>There are other cases, where parameters, arguments or array items can change up and down:</p>
<pre><code class="language-diff">-$someObject = new SomeClass(
-    $shortArg
-);
+$someObject = new SomeClass($shortArg);</code></pre>
<pre><code class="language-diff">-$someArray = ['superlooongArgumentsover120chars', 'superlooongArgumentsover120chars', 'superlooongArgumentsover120chars'];
+$someArray = [
+    'superlooongArgumentsover120chars',
+    'superlooongArgumentsover120chars',
+    'superlooongArgumentsover120chars'
+];</code></pre>
<p>What if I told you that you'll have to never deal with this manually. Ever!</p>
<p>Welcome <code>LineLengthFixer</code>.</p>
<h3 id="How-to-Register-It">How to Register It?</h3>
<pre><code class="language-php">use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
use Symplify\CodingStandard\Fixer\LineLength\LineLengthFixer;

return function (ContainerConfigurator $containerConfigurator): void {
    $services = $containerConfigurator-&gt;services();
    $services-&gt;set(LineLengthFixer::class);
};</code></pre>
<p>As you guessed, this fixer works with 120 chars as maximum line-size... by default ↓</p>
<p><br></p>
<h2 id="2-Choose-Line-Length-to-Match-Your-Display">2. Choose Line Length to Match Your Display</h2>
<p><a href="https://github.com/symplify/symplify/pull/747" class="btn btn-dark btn-sm mt-2 mb-3">
Check the PR #751
</a></p>
<ul>
<li>Do you prefer shorter or longer lines?</li>
<li>Do you want use breaks only and not inline short code?</li>
</ul>
<pre><code class="language-php">use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;
use Symplify\CodingStandard\Fixer\LineLength\LineLengthFixer;

return function (ContainerConfigurator $containerConfigurator): void {
    $services = $containerConfigurator-&gt;services();

    $services-&gt;set(LineLengthFixer::class)
        -&gt;call('configure', [[
            'max_line_length' =&gt; 100, # default: 120
            'break_long_lines' =&gt; true, # default: true
            'inline_short_lines' =&gt; false, # default: true
        ]]);
};</code></pre>
<p><br></p>
<h2 id="3-Make-your-Static-Classes-visible">3. Make your Static Classes visible</h2>
<p>It started as one simple static method. A helper method. They say: it's ok to use static methods, when you know when to use them. And that's <strong>how cancer started to spread slowly and lethally through Symplify code</strong>.</p>
<p>One day you wake up and from 1 static method is 60 static factories all over your code - Dependency Injection for very poor. And that not the worst. When all code works and is easy to maintain, 1 static method can't hurt it, right?</p>
<p><strong>Well until you need to replace one of nested dependencies that requires few more classes. And then you realized your work is to basically manually maintain dump of dependency injection container</strong> and that you're not coding anymore.</p>
<p>It took weeks to get from this position back to clear dependency injection and I don't want to do it ever again. That's why this PHPStan rule was born.</p>
<h3 id="How-to-Register-It">How to Register It?</h3>
<pre><code class="language-yaml">rules:
    - Symplify\CodingStandard\Rules\NoClassWithStaticMethodWithoutStaticNameRule</code></pre>
<p><br></p>
<h2 id="4-Prevent-and-amp-references-with-ForbiddenStaticFunctionSniff">4. Prevent &amp; references with <code>ForbiddenStaticFunctionSniff</code></h2>
<p><a href="https://github.com/symplify/symplify/pull/692" class="btn btn-dark btn-sm mt-2 mb-3">
Check the PR #692
</a></p>
<p>We all already know that <code>&amp;$references</code> are bad practise, since they increase cyclomatic complexity and hide dependency logic.</p>
<pre><code class="language-php">function someFunction(&amp;$var)
{
    $var + 1;
}</code></pre>
<p>And that we should prefer explicit syntax:</p>
<pre><code class="language-php">function someFunction($var)
{
    return $var + 1;
}</code></pre>
<p>I though I would never meet them again, but they somehow pop-up in PRs. So we made a PHPStan rule for it:</p>
<h3 id="How-to-Register-It">How to Register It?</h3>
<pre><code class="language-yaml"># phpstan.neon
rules:
    - Symplify\CodingStandard\Rules\NoReferenceRule</code></pre>
<p><br></p>
<h2 id="5-Clear-Child-Class-Naming-Once-and-For-All-with-ClassNameSuffixByParentFixer">5. Clear Child Class Naming Once and For All with <code>ClassNameSuffixByParentFixer</code></h2>
<p><a href="https://github.com/symplify/symplify/pull/633" class="btn btn-dark btn-sm mt-2 mb-3">
Check the PR #633
</a></p>
<p>Often in the code of private companies there are classes like:</p>
<ul>
<li><code>ProductSorter</code></li>
<li><code>ProductSorter</code></li>
<li><code>ProductSorter</code></li>
</ul>
<p>If you use PhpStorm and <em>open file</em> shortcut, you know where I aim.</p>
<p>Now, imagine you want to update the Command that sorts Products by price to Redis database. Inside, it looks like this:</p>
<pre><code class="language-php">final class ProductSorter extends Command
{
    // ...
}</code></pre>
<h3 id="Which-one-do-you-open">Which one do you open?</h3>
<p>I could also ask, which one is the interface and which is its implementation, but <a href="https://github.com/symplify/coding-standard#class-should-have-suffix-by-parent-classinterface">there is already checker for that</a>.</p>
<p>Probably each of them manually until you find the right one, which really sucks. That why not only methods names, <strong>but also class names should be as descriptive and as deterministic as possible</strong>. Like this:</p>
<pre><code class="language-diff">-final class ProductSorter extends Command
+final class ProductSorterCommand extends Command
 {
     // ...
 }</code></pre>
<p>And then you have clear class names, that you're able to distinguish without their content:</p>
<ul>
<li><code>ProductSorterCommand</code></li>
<li><code>ProductSorterRepository</code></li>
<li><code>ProductSorterController</code></li>
</ul>
<p>And that's exactly what <code>ClassNameRespectsParentSuffixRule</code> helps you to do.</p>
<h3 id="How-to-Register-It">How to Register It?</h3>
<pre><code class="language-yaml"># phpstan.neon
rules:
    - Symplify\CodingStandard\Rules\ClassNameRespectsParentSuffixRule

parameters:
    symplify:
        # it handles many default cases, but allows you to add your own
        forbidden_parent_classes: []</code></pre>
<p><br><br></p>
<p>Happy sniffing and fixing!</p>

            <br>


            <div class="card mt-5 border-warning">
                <div class="card-body text-center mt-2">
                    <p>
                        Have you find this post useful? <strong>Do you want more?</strong>
                    </p>
                    <p>
                        Follow me on <a href="https://twitter.com/votrubaT">Twitter</a>, <a href="/rss.xml">RSS</a> or support me on <a href="https://github.com/sponsors/TomasVotruba">GitHub Sponsors</a>.
                    </p>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-body text-white bg-success text-center">
                                            <a href="/blog/2018/03/26/new-in-easy-coding-standard-4-clean-symfony-standard-with-yaml-and-services" class="d-block">
                            <div>
                                Read next → <strong>New in Easy Coding Standard 4: Clean Symfony Standard with Yaml and Services</strong>
                            </div>
                        </a>
                                    </div>
            </div>

            <br>
            <br>

            <a name="comments"></a>
            <div id="disqus_thread"></div>

<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://itsworthsharing.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
        </div>

        <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>

        <link href="/assets/prism/prism.css" rel="stylesheet" type="text/css" />
        <script src="/assets/prism/prism.js"></script>

        <script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

        <script type="text/javascript">
            // @see https://stackoverflow.com/a/30776817/1348344
            var date = new Date();
            // display every 2nd hour, not to spam users
            if (date.getHours() % 2 === 1) {
                document.querySelector('.book-banner').style.display = 'visible';
            } else {
                document.querySelector('.book-banner').style.display = 'none';
            }
        </script>
    </body>
</html>
