<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Rector: Part 3 - Why Instant Upgrades | Tomas Votruba</title>
<meta charset="utf-8">
<meta name="robots" content="index, follow">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:creator" content="@votrubaT"/>

<meta property="og:image" content="/assets/images/tomas_votruba.jpg"/>

<link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">


<link rel="stylesheet" rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:700&amp;display=swap" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" media="print" onload="this.media='all'">

<link href="/assets/css/style.css?1372988067" rel="stylesheet" type="text/css" />

                <meta property="og:title" content="Rector: Part 3 - Why Instant Upgrades" />
        <meta property="og:url" content="https://tomasvotruba.com/blog/2018/03/05/rector-part-3-why-instant-upgrades" />
        <meta name="description" property="og:description" content="Why are instant upgrades better than old school *manual upgrades*? Why is the path to find exact before/after like hell-road?
Why you should use Rector and when?
" />

            </head>

    <body>
        <!-- post_id: 81 -->
        <div id="menu">
    <div class="container-fluid">
        <a href="/">Home</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/blog">Blog</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/book/the-power-of-automated-refactoring">Book</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/trainings">Trainings</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/contact">Contact</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/about-me">About Me</a>
        <span class="pl-2 pr-2">•</span>

        <a href="https://twitter.com/votrubaT" target="blank">Twitter</a>
        <span class="pl-2 pr-2">•</span>

        <a href="/rss.xml" target="blank">RSS</a>
    </div>
</div>

        <div class="container-fluid post" id="content">
            <div class="text-center book-banner">
                <a href="https://leanpub.com/rector-the-power-of-automated-refactoring" target="blank" class="text-center">
                    <img src="/assets/images/banner-rector-book.png" class="mb-2 ml-auto mr-auto rounded " style="max-height: 5em" alt="">
                </a>
            </div>

            <h1>Rector: Part 3 - Why Instant Upgrades</h1>

            <div class="pull-right">
                <a href="https://github.com/tomasvotruba/tomasvotruba.com/edit/main/packages/blog/data/2018/2018-03-05-rector-part-3-why-instant-upgrades.md">Found a typo? Edit me</a>
            </div>

            <time datetime="2018-03-Mon" class="text-muted">
                2018-03-05
            </time>

            
            
            <div class="card card-bigger mb-5">
                <div class="card-body pb-2">
                    <p>Why are instant upgrades better than old school <em>manual upgrades</em>? Why is the path to find exact before/after like hell-road?
Why you should use Rector and when?</p>
                </div>
            </div>

            <p><em>Read also:</em></p>
<ul>
<li><a href="/blog/2018/02/19/rector-part-1-what-and-how/">Part 1 - What and How</a></li>
<li><a href="/blog/2018/02/26/rector-part-2-maturity-of-php-ecocystem-and-founding-fathers/">Part 2 - Maturity of PHP Ecosystem and Founding Fathers</a></li>
</ul>
<p><br></p>
<h2 id="Why-was-Rector-needed">Why was Rector needed</h2>
<p>You need 2 things to upgrade PHP application to newer version of the framework you use:</p>
<h3 id="1-The-Knowledge">1. The Knowledge</h3>
<p>Most of you follow changes in Symfony or Nette. You know that <a href="https://github.com/symfony/symfony/blob/master/UPGRADE-4.0.md#process"><code>ProcessBuilder</code> was removed</a> and that you'll have to migrate to <code>Process</code> class only. You know that <a href="https://forum.nette.org/cs/26250-pojdte-otestovat-nette-2-4-rc"><code>Nette\Object</code> was removed</a> and that you'll have to rewrite all <code>@method</code> annotation to real methods.</p>
<p>You read blogs, follow news on forum, read all <code>CHANGELOG.md</code> and <code>UPGRADE.md</code> files and sometimes commits, to find out what all has changed. <strong>You have the knowledge</strong>.</p>
<p>Or don't you? <strong>Imagine you could drop delegate all this to a computer.</strong></p>
<h3 id="2-The-Resources">2. The Resources</h3>
<p>You work in a company where up-to-date it very important value. Your employer finances upgrades and also your education in it (pays you to get the knowledge). Once a 6 months you have dedicated paid time to update all packages to most recent versions. <strong>You have the resources</strong></p>
<p>Do you find yourself in such situation? If so, <strong>you belong to 5 % blessed and active people around me.</strong></p>
<h2 id="How-Expensive-are-Upgrades-Now">How Expensive are Upgrades Now?</h2>
<p>From my experience with consulting over 50 PHP projects in last 4 years, it can take 80-400 hours per one minor version upgrade (e.g. Symfony 2.7 → 2.8), including all deprecations.</p>
<h3 id="1-Teams-are-not-Supported-in-Upgrades">1. Teams are not Supported in Upgrades</h3>
<p>Teams don't have space to find out what changed between Symfony 2.7 and Symfony 2.8. They don't care, because their employer cares mostly about creating new website as fast and as cheap as possible. And that's logical.</p>
<p>That's why most of <a href="/trainings">lectures</a> I make is about giving teams <em>the knowledge</em> that they can use with their very limited resources to make the best out of it.</p>
<p>Such approach also naturally leads to huge legacy code, team performance drop from 100 % to 20 %, which consequently leads to hiring 5x more people to keep productivity the same, more money, and pressure to faster development, which lead to huge legacy code...</p>
<h3 id="2-Are-Deprecations-Easy-to-Find">2. Are Deprecations Easy to Find?</h3>
<p>Let's say you have time to explore the Internet, follow <a href="https://twitter.com/symfony_en">Symfony News on Twitter</a>, read <a href="https://symfony.com/blog/category/living-on-the-edge">every news post on Symfony Blog</a> or know where on the Nette forum are located <a href="https://forum.nette.org/en/f78-release-announcements-news">Release Notes</a>.</p>
<p>Sometimes if you're lucky there is <code>UPGRADE-x.md</code> in project's Github repository, like <a href="https://github.com/symfony/symfony/blob/master/UPGRADE-4.0.md"><code>UPGRADE-4.0.md</code></a> in Symfony 4 repository. But what if you need upgrade to version 3.x? Could you find it? Well no, but yes in <a href="https://github.com/symfony/symfony/tree/3.4">3.x branch</a>.</p>
<p>And sometimes these changes are in files called <code>CHANGELOG-x.md</code>. But more often <strong>they're newer to be seen and you have to go <code>git blame</code> in Github specific line and hope for an answer</strong>. And just pray that there is PR with more detailed changes with tests as well and not direct set of commits to the <code>master</code> branch without context.</p>
<img src="/assets/images/posts/2018/rector-3/frustration.jpg" class="img-thumbnail">
<h3 id="3-When-We-Find-Them-are-They-Valid">3. When We Find Them, are They Valid?</h3>
<p>Sometimes there can be bare useless description, like <a href="https://github.com/symfony/symfony/blob/master/UPGRADE-4.0.md#process">in <code>UPGRADE-4.0</code></a>:</p>
<p><em>The <code>Symfony\Component\Process\ProcessBuilder</code> class has been removed, use the <code>Symfony\Component\Process\Process</code> class directly instead.</em></p>
<p>Do you mean like this?</p>
<pre><code class="language-diff">-use Symfony\Component\Process\ProcessBuilder;
+use Symfony\Component\Process\Process;

-$builder = new ProcessBuilder();
+$builder = new Process();
 $builder-&gt;setArguments(['build', '-force', '-var "blah=blah"', 'path/to/json.json'])
    -&gt;getProcess();</code></pre>
<p>Unfortunately no and our investigative programming begins. Git blame..., Google? Symfony Docs?</p>
<p>Sometimes <strong>they are embodied in the best place - the code</strong>. Kudos to all developers who do it like that! When running this method, you'll be informed:</p>
<pre><code class="language-php">public function add()
{
    trigger_error('Method add() is deprecated, use addHtml() instead.', E_USER_DEPRECATED);
}</code></pre>
<h3 id="4-Found-them-and-Valid-But-are-They-Standardized">4. Found them and Valid! But are They Standardized?</h3>
<p>Sometimes the maintainer goes as far to deprecate code slowly (!= remove):</p>
<pre><code class="language-php">trigger_error('Method add() is deprecated, use addHtml() instead.', E_USER_DEPRECATED);</code></pre>
<p>Which is good enough for start. Symfony even has <a href="https://symfony.com/doc/current/components/phpunit_bridge.html">PHPUnit Bridge</a> that tries to detect those deprecations. Would you know what exactly do you need to change?</p>
<img src="/assets/images/posts/2018/rector-3/report.png" class="img-thumbnail">
<p>But what class? What line?</p>
<p>But that's not the only &quot;standard&quot;.</p>
<p><a href="https://xkcd.com/927/
"></p>
<img src="https://imgs.xkcd.com/comics/standards.png" class="img-thumbnail">
<p></a></p>
<p>There is one more way I wrote about in <a href="/blog/2017/09/11/how-to-write-open-source-in-php-3-deprecating-code/#today-s-topic-changed-method-name">How to write Open-Source in PHP 3: Deprecating Code</a>.</p>
<p>The <code>@deprecated</code> annotation:</p>
<pre><code class="language-php">/**
 * @deprecated Method add() is deprecated, use addHtml() instead
 */
public function add()
{
    // ...
}</code></pre>
<p>Which is rather note in the code than helpful to user, like concept post about that great idea your never published. <strong>What happens when <code>-&gt;add()</code> method is called? Nothing.</strong> And in next mayor version you get <em>calling non-existing method</em> error.</p>
<p>Similar tool to PHPUnit Bridge is <a href="https://github.com/sensiolabs-de/deprecation-detector"><code>deprecation-detector</code></a>, that tries to catch code with <code>@deprecated</code> annotation. Again, not much standardized.</p>
<p>And that's Symfony, my friends, which <strong>does the best job for <a href="https://symfony.com/doc/current/contributing/code/bc.html">Backward Compatibility Promise</a> in PHP</strong>. <strong>What about those other 50 packages your application uses?</strong></p>
<h3 id="Outsource-all-this">Outsource all this?</h3>
<p>Would you like to do this job instead of developing your application? Most people wouldn't, so they hire me as a consultant to help them with it. <strong>But would you hire somebody, who would download all dependencies your application need in correct version for you or would you rather start using composer?</strong></p>
<h2 id="Embodied-Cognition-instead-of-Investigative-Programming">Embodied Cognition instead of Investigative Programming</h2>
<p>I consulted over 50 projects in great depth of legacy. We always tried to figure out, where to start.</p>
<ul>
<li>&quot;This is how it's done in your project, and this is the way in Symfony.&quot;</li>
</ul>
<p>or</p>
<ul>
<li>&quot;This is how it's done in Symfony 2.8 and this is the way in Symfony 3.0.&quot;</li>
</ul>
<h3 id="Legacy-Projects-Well-Paid-Projects-The-Way-Go">Legacy Projects === Well Paid Projects !== The Way Go</h3>
<p>Over and over again, just version numbers and the desired framework change. After few years I started to feel like <em>a dumb copy-paster</em>. I follow every new feature on Symfony, test it, verify its usefulness, then distill 100 hours of my work to 3 hour lecture. I'm lazy and this started to itch my mind. Is this the really education I want to encourage in the world? Well, majority of lecturers do exactly same work, well paid work. But is that reason to do it too?</p>
<h3 id="Delegate-Procreate">Delegate → Procreate</h3>
<p>I borrow a term from psychology - <strong>embodied cognition</strong>. It's something you don't have to remember, cause it's in you. It's like riding a bike. I don't know what words to use and where to find out how to ride a bike - I just know it, cause it's in  my internal reflexes.</p>
<p>Could something similar happen to upgrading applications? A single place that knows what to do and doesn't have to explain every programmer over and over again?</p>
<p><br></p>
<p>These all kinds of problems Rector solves for you.</p>

            <br>


            <div class="card mt-5 border-warning">
                <div class="card-body text-center mt-2">
                    <p>
                        Have you find this post useful? <strong>Do you want more?</strong>
                    </p>
                    <p>
                        Follow me on <a href="https://twitter.com/votrubaT">Twitter</a>, <a href="/rss.xml">RSS</a> or support me on <a href="https://github.com/sponsors/TomasVotruba">GitHub Sponsors</a>.
                    </p>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-body text-white bg-success text-center">
                                            <a href="/blog/2018/03/08/why-is-collector-pattern-so-awesome" class="d-block">
                            <div>
                                Read next → <strong>Why is Collector Pattern so Awesome</strong>
                            </div>
                        </a>
                                    </div>
            </div>

            <br>
            <br>

            <a name="comments"></a>
            <div id="disqus_thread"></div>

<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://itsworthsharing.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
        </div>

        <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>

        <link href="/assets/prism/prism.css" rel="stylesheet" type="text/css" />
        <script src="/assets/prism/prism.js"></script>

        <script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

        <script type="text/javascript">
            // @see https://stackoverflow.com/a/30776817/1348344
            var date = new Date();
            // display every 2nd hour, not to spam users
            if (date.getHours() % 2 === 1) {
                document.querySelector('.book-banner').style.display = 'visible';
            } else {
                document.querySelector('.book-banner').style.display = 'none';
            }
        </script>
    </body>
</html>
